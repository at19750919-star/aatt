<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <!-- =================================================================== -->
    <!-- === 1. é é¢åŸºæœ¬è¨­å®š (Meta & Title) === -->
    <!-- =================================================================== -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç´…è‰²0é»ç‰Œè¨Šè™Ÿæ¸¬è©¦</title>

    <!-- =================================================================== -->
    <!-- === 2. CSS æ¨£å¼å€ (Styling) === -->
    <!-- =================================================================== -->
    <style>
        /* --- è¨ˆç®—å·¥å…·æ‡¸æµ®è¦–çª— --- */
        .floating-widget {
            position: fixed;
            top: 100px;
            left: 100px;
            background: #2c2c2c;
            border-radius: 10px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.55);
            border: 1px solid #4a4a4a;
            display: none;
            width: auto;
            min-width: 300px;
            max-width: 380px;
            padding: 6px;
            z-index: 9999;
        }
        .widget-content {
            padding: 6px;
            display: flex;
            flex-direction: column;
            gap: 8px;
            color: #fff;
        }
        .widget-actions {
            display: flex;
            gap: 6px;
        }
        .widget-action {
            border: none;
            border-radius: 6px;
            padding: 6px 10px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            color: #fff;
            background: #3c3c3c;
            transition: background-color 0.2s ease, color 0.2s ease;
        }
        .widget-close { background: #555; }
        .widget-close:hover { background: #6d6d6d; }
        .widget-reset { background: #d9534f; flex: 1; }
        .widget-reset:hover { background: #c9302c; }
        .widget-content .card-inputs {
            display: grid;
            grid-template-columns: repeat(6, 44px);
            gap: 4px;
            justify-content: center;
        }
        .widget-content .card-input {
            width: 44px;
            height: 32px;
            text-align: center;
            font-size: 16px;
            font-weight: 600;
            background: #343434;
            border: 1px solid #555;
            color: #fff;
            border-radius: 5px;
            transition: all 0.2s ease;
            box-sizing: border-box;
            padding: 0;
        }
        .widget-content .card-input:focus {
            outline: none;
            border-color: #66aaff;
            box-shadow: 0 0 3px rgba(102, 170, 255, 0.4);
        }
        .widget-content .card-input.disabled {
            background: #1f1f1f;
            border-color: #333;
            color: #666;
            pointer-events: none;
        }
        .widget-content .card-input.highlight {
            border-color: #ffcc00;
            background: #4d462f;
        }
        .widget-content .results {
            display: grid;
            gap: 6px;
        }
        .widget-content .result-strip {
            display: grid;
            grid-template-columns: repeat(3, minmax(0, 1fr));
            gap: 6px;
            background: #2f2f2f;
            border-radius: 8px;
            padding: 6px;
        }
        .widget-content .result-value {
            font-size: 22px;
            font-weight: 700;
            color: #fff;
            text-align: center;
            padding: 6px 0;
            border-radius: 6px;
            background: #3f3f3f;
        }
        .widget-content .result-player { color: #73b4ff; background: #2c3648; }
        .widget-content .result-banker { color: #ff8673; background: #3f2930; }
        .widget-content .result-outcome { color: #fff; }
        .widget-content .result-value.win-B { background: #d9534f; color: #fff; }
        .widget-content .result-value.win-P { background: #428bca; color: #fff; }
        .widget-content .result-value.win-T { background: #5cb85c; color: #041904; }

        /* --- å…¨åŸŸèˆ‡åŸºç¤ä½ˆå±€ --- */
        body {
            font-family: 'Microsoft JhengHei', sans-serif; /* è¨­å®šç¶²ç«™é è¨­å­—é«” */
            margin: 0; /* ç§»é™¤é é¢é è¨­é‚Šè· */
            background: #f5f5f5; /* è¨­å®šé é¢èƒŒæ™¯ç‚ºæ·ºç°è‰² */
        }
        .container {
            width: 100%; /* ä¸»è¦å…§å®¹å€å¡Šå¯¬åº¦ä½”æ»¿ */
            margin: 0; /* ç§»é™¤é‚Šè· */
            background: white; /* å…§å®¹å€å¡ŠèƒŒæ™¯ç‚ºç™½è‰² */
            padding: 20px; /* å…§å®¹å€å¡Šçš„å…§é‚Šè· */
            box-sizing: border-box; /* è®“ padding ä¸æœƒæ’å¤§å€å¡Šå¯¬åº¦ */
        }

        /* --- ä¸»è¦åŠŸèƒ½å€å¡Š (ä¾‹å¦‚å‰µå»ºå€ã€ç·¨è¼¯å€) --- */
        .controls {
            margin-bottom: 20px; /* å€å¡Šä¹‹é–“çš„ä¸‹æ–¹é–“è· */
            padding: 15px; /* å€å¡Šçš„å…§é‚Šè· */
            background: #f8f9fa; /* å€å¡ŠèƒŒæ™¯è‰² */
            border-radius: 6px; /* å€å¡Šçš„åœ“è§’ */
        }
        .controls h3 {
            margin-top: 0; /* ç§»é™¤æ¨™é¡Œçš„ä¸Šæ–¹é–“è· */
            border-bottom: 1px solid #dee2e6; /* æ¨™é¡Œä¸‹æ–¹çš„åˆ†éš”ç·š */
            padding-bottom: 10px; /* æ¨™é¡Œèˆ‡å…§å®¹çš„é–“è· */
            margin-bottom: 15px; /* æ¨™é¡Œèˆ‡å…§å®¹çš„é–“è· */
        }

        /* --- æŒ‰éˆ•æ¨£å¼ --- */
        /* ä¸€èˆ¬åŠŸèƒ½æŒ‰éˆ• (ä¾‹å¦‚ç”Ÿæˆç‰Œé´) */
        .controls button {
            padding: 10px 20px; /* æŒ‰éˆ•çš„å…§é‚Šè· (ä¸Šä¸‹/å·¦å³) */
            margin-right: 10px; /* æŒ‰éˆ•ä¹‹é–“çš„å³é‚Šè· */
            border: none; /* ç§»é™¤é‚Šæ¡† */
            border-radius: 4px; /* æŒ‰éˆ•åœ“è§’ */
            background: #007bff; /* æŒ‰éˆ•èƒŒæ™¯è‰² (è—è‰²) */
            color: white; /* æ–‡å­—é¡è‰² */
            cursor: pointer; /* æ»‘é¼ ç§»ä¸Šå»æ™‚é¡¯ç¤ºæ‰‹å½¢æŒ‡æ¨™ */
        }
        .controls button:hover {
            background: #0056b3; /* æ»‘é¼ æ‡¸åœæ™‚çš„èƒŒæ™¯è‰² */
        }
        .controls button:disabled {
            background: #ccc; /* æŒ‰éˆ•è¢«ç¦ç”¨æ™‚çš„èƒŒæ™¯è‰² */
            cursor: not-allowed; /* ç¦ç”¨æ™‚çš„æ»‘é¼ æŒ‡æ¨™ */
        }
        /* å¿«é€Ÿé¸æ“‡æŒ‰éˆ• (ä¾‹å¦‚å…¨é¸ã€æ¸…ç©º) */
        .quick-btn {
            padding: 4px 8px;
            margin: 2px 4px;
            background: #6c757d; /* ç°è‰²èƒŒæ™¯ */
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px; /* è¼ƒå°çš„å­—é«” */
        }
        .quick-btn:hover {
            background: #5a6268;
        }
        .control-inline {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        .control-inline label {
            margin-bottom: 0;
            font-weight: 600;
        }
        .quick-btn-group {
            display: inline-flex;
            flex-wrap: wrap;
            gap: 6px;
        }
        .rank-checkboxes {
            display: inline-flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        /* --- ç‰Œé´ç¶²æ ¼ --- */
        .mini-grid-wrapper {
            margin: 12px 0;
            border: 1px solid #ced4da;
            border-radius: 10px;
            background: #0f1424;
            overflow: hidden;
        }
        .grid-preview {
            display: grid;
            grid-template-columns: repeat(15, 1fr);
            gap: 0;
            border-radius: 10px;
            overflow: hidden;
        }
        .grid-preview.mini {
            max-height: none;
            overflow-y: visible;
        }
        .grid-preview .cell {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 20px;
            font-size: 14px;
            font-weight: 600;
            border: 1px solid rgba(255,255,255,0.05);
            background: #0e1420;
            color: #e6eef8;
        }
        .grid-preview .cell.card-red { background-color: #f8d7da; color: #92000f; }
        .grid-preview .cell.card-blue { background-color: #d4e9ff; color: #0b3c7e; }
        .grid-preview .cell.signal-match { color: #ff4d4f; font-weight: 700; }
        .grid-preview .cell.tbox-left { border-left: 2px solid #ff4d4f; }
        .grid-preview .cell.tbox-right { border-right: 2px solid #ff4d4f; }
        .grid-preview .cell.tbox-top { border-top: 2px solid #ff4d4f; }
        .grid-preview .cell.tbox-bottom { border-bottom: 2px solid #ff4d4f; }
        .grid-preview .cell.segment-b { opacity: 0.9; }
        .grid-preview .cell.segment-c { opacity: 0.7; }
        .grid-placeholder {
            text-align: center;
            padding: 20px;
            font-size: 13px;
            color: #adb5bd;
        }

        /* --- çµ±è¨ˆæ•¸æ“šå¡ç‰‡ --- */
        .stats {
            display: grid; /* ä½¿ç”¨æ ¼ç·šä½ˆå±€ */
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); /* è‡ªé©æ‡‰æ¬„ä½æ•¸é‡ */
            gap: 10px; /* å¡ç‰‡ä¹‹é–“çš„é–“è· */
            margin-bottom: 16px;
        }
        .stat-card {
            padding: 10px 12px;
            background: #e9ecef; /* å¡ç‰‡èƒŒæ™¯è‰² */
            border-radius: 6px;
            text-align: center; /* æ–‡å­—ç½®ä¸­ */
        }
        .stat-card h3 {
            margin: 0 0 6px 0;
            color: #495057;
            font-size: 14px;
            border: none; /* ç§»é™¤å¡ç‰‡å…§çš„æ¨™é¡Œåº•ç·š */
        }
        .stat-card .value {
            font-size: 18px;
            font-weight: bold;
            color: #28a745; /* æ•¸å€¼æ–‡å­—é¡è‰² (ç¶ è‰²) */
        }

        /* --- çµæœé¡¯ç¤ºè¡¨æ ¼ --- */
        .rounds-table {
            width: 100%;
            border-collapse: collapse; /* è®“å„²å­˜æ ¼é‚Šæ¡†åˆä½µ */
            margin-top: 20px;
        }
        .rounds-table th,
        .rounds-table td {
            border: 1px solid #dee2e6; /* è¡¨æ ¼é‚Šæ¡†é¡è‰² */
            padding: 2px; /* å„²å­˜æ ¼å…§é‚Šè· */
            text-align: center;
        }
        .rounds-table th {
            background: #f8f9fa; /* è¡¨é ­èƒŒæ™¯è‰² */
            font-weight: bold;
        }

        /* --- è¡¨æ ¼å…§çš„ç‰¹æ®Šå…ƒç´ æ¨£å¼ --- */
        /* ã€Œå¡è‰²ã€æ¬„ä½çš„å°æ–¹å¡Š */
        .color-chips { display: inline-flex; gap: 4px; }
        .color-chip { display: inline-block; width: 24px; height: 24px; line-height: 24px; border-radius: 4px; font-size: 18px; font-weight: bold; color: #fff; }
        .color-chip.red { background: #dc3545; } /* ç´…è‰²æ–¹å¡Š */
        .color-chip.blue { background: #007bff; } /* è—è‰²æ–¹å¡Š */
        .color-chip.unknown { background: #adb5bd; color: #212529; } /* æœªçŸ¥æ–¹å¡Š */

        /* ã€Œå¡ç‰Œã€æ¬„ä½çš„æ¨™ç±¤ */
        .card-label { display: inline-block; margin: 0 2px 2px 0; padding: 2px 2px; border-radius: 4px; background: #f1f3f5; color: #6c757d; font-size: 16px; transition: color 0.2s ease; }
        .card-label.s-signal-card { color: #c62828; font-weight: 600; }
        .card-label.non-s-signal-card { color: #6c757d; }
        .card-back-blue { background: #d4e9ff !important; } /* è—èƒŒå¡ç‰ŒèƒŒæ™¯ (åŠ ä¸Š !important ç¢ºä¿å„ªå…ˆç´š) */
        .card-back-red { background: #f8d7da !important; } /* ç´…èƒŒå¡ç‰ŒèƒŒæ™¯ (åŠ ä¸Š !important ç¢ºä¿å„ªå…ˆç´š) */
        .card-back-unknown { background: #dee2e6; } /* æœªçŸ¥å¡èƒŒèƒŒæ™¯ */

        /* --- ç‰¹æ®Šç‹€æ…‹é«˜äº® --- */
        .two-pairs-round { background: #e7f3ff !important; } /* ã€Œå…©å°ã€å±€çš„æ•´è¡Œé«˜äº® */
        .red-zero { color: #92000f; font-weight: bold; } /* ã€Œè¨Šè™Ÿç‰Œã€çš„æ–‡å­—é«˜äº® (æ·±ç´…è‰²) */
        .zero-card { background: #d4edda; } /* (å‚™ç”¨) è¨Šè™Ÿç‰ŒèƒŒæ™¯è‰² */
        .result-banker { color: #dc3545; font-weight: bold; } /* ã€ŒèŠã€çµæœé«˜äº® */
        .result-player { color: #007bff; font-weight: bold; } /* ã€Œé–’ã€çµæœé«˜äº® */
        .result-tie { color: #28a745; font-weight: bold; } /* ã€Œå’Œã€çµæœé«˜äº® */

        /* --- æ—¥èªŒã€æ‡¸æµ®æŒ‰éˆ•èˆ‡ç·¨è¼¯å·¥å…·åˆ— --- */
        .results-split { display: flex; flex-wrap: wrap; gap: 20px; align-items: stretch; }
        .left-pane { flex: 6 1 0; min-width: 0; }
        .right-pane { flex: 4 1 0; min-width: 260px; max-width: none; }
        .log { background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 6px; padding: 16px; min-height: 420px; max-height: 80vh; overflow-y: auto; font-family: monospace; font-size: 13px; line-height: 1.45; }
        .log .success { color: #28a745; } /* æˆåŠŸæ—¥èªŒ */
        .log .error { color: #dc3545; } /* éŒ¯èª¤æ—¥èªŒ */
        .log .info { color: #17a2b8; } /* è³‡è¨Šæ—¥èªŒ */
        .back-to-main { position: fixed; top: 20px; right: 20px; left: auto; width: 48px; height: 48px; border-radius: 12px; border: 2px solid rgba(255, 255, 255, 0.2); background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; font-size: 24px; cursor: pointer; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3); transition: all 0.3s ease; z-index: 9999; }
        .back-to-main:hover { transform: translateY(-2px) scale(1.05); box-shadow: 0 6px 20px rgba(245, 87, 108, 0.4); }
        .panel-dark { background: #23283a; color: #f1f5ff; border-radius: 12px; box-shadow: inset 0 0 0 1px rgba(255,255,255,0.08); padding: 16px 20px; margin-bottom: 18px; }
        .edit-buttons { display: flex; align-items: center; gap: 10px; flex-wrap: wrap; margin-bottom: 12px; }
        .edit-buttons .btn, .tool-buttons .btn { padding: 8px 18px; border-radius: 8px; border: none; font-size: 15px; cursor: pointer; transition: transform 0.15s ease, box-shadow 0.15s ease, opacity 0.15s ease; background: rgba(255,255,255,0.08); color: #f5f7ff; }
        .edit-buttons .btn:hover:not(:disabled), .tool-buttons .btn:hover:not(:disabled) { transform: translateY(-1px); box-shadow: 0 6px 14px rgba(0,0,0,0.25); }
        .edit-buttons .btn:disabled, .tool-buttons .btn:disabled { opacity: 0.45; cursor: not-allowed; }
        .edit-buttons .btn.secondary, .tool-buttons .btn.secondary { background: rgba(255,255,255,0.04); }
        .edit-buttons .btn.primary { background: linear-gradient(135deg, #2ed573 0%, #1dd1a1 100%); color: #0b1f16; font-weight: 600; }
        .edit-buttons .btn.alert, .tool-buttons .btn.alert { background: rgba(245, 61, 86, 0.25); color: #ff6b81; }
        .edit-buttons .btn.active { box-shadow: 0 0 0 2px rgba(46,213,115,0.45), 0 6px 16px rgba(0,0,0,0.28); transform: translateY(-1px); }
        .tool-buttons { display: flex; align-items: center; gap: 12px; flex-wrap: wrap; margin-top: 10px; }
        .tool-buttons .input-inline { display: inline-flex; align-items: center; background: rgba(255,255,255,0.08); padding: 6px 10px; border-radius: 6px; color: #cdd6f4; }
        .tool-buttons .input-inline input { background: transparent; border: none; outline: none; width: 80px; color: #fff; font-size: 15px; margin-left: 8px; }
        .hotkey-info { display: flex; flex-wrap: wrap; gap: 8px 14px; padding: 10px 12px; border-radius: 8px; background: rgba(255,255,255,0.04); font-size: 13px; line-height: 1.4; }
        .hotkey-info .hotkey-item { display: flex; align-items: center; gap: 6px; color: rgba(241,245,255,0.78); }
        .hotkey-info .hotkey-key { display: inline-flex; align-items: center; justify-content: center; padding: 2px 8px; border-radius: 5px; background: rgba(255,255,255,0.12); color: #fff; font-family: "JetBrains Mono", monospace; font-size: 12px; box-shadow: inset 0 0 0 1px rgba(255,255,255,0.08); }
        @media (max-width: 900px) {
            .left-pane, .right-pane { flex: 1 1 100%; }
            .log { min-height: 300px; max-height: none; }
        }
        .card-label.selected-first { box-shadow: 0 0 0 2px rgba(255,214,102,0.9); border-radius: 6px; background: rgba(255,214,102,0.15); }
        .card-label.selected-second { box-shadow: 0 0 0 2px rgba(105,192,255,0.9); border-radius: 6px; background: rgba(105,192,255,0.12); }
        .round-row.selected-first { outline: 3px solid rgba(255,214,102,0.85); }
        .round-row.selected-second { outline: 3px solid rgba(105,192,255,0.85); }
        .signal-summary { margin-top: 16px; }
        .signal-summary .summary-title { font-size: 15px; color: rgba(255,255,255,0.72); margin-bottom: 8px; letter-spacing: 0.5px; }
        .signal-summary .stats-table { width: 100%; border-collapse: collapse; background: rgba(31, 37, 58, 0.95); border-radius: 10px; overflow: hidden; font-size: 14px; color: #e6ecff; }
        .signal-summary .stats-table thead { background: rgba(255,255,255,0.06); }
        .signal-summary .stats-table th,
        .signal-summary .stats-table td { padding: 6px 8px; text-align: center; border-bottom: 1px solid rgba(255,255,255,0.05); white-space: nowrap; }
        .signal-summary .stats-table td:first-child,
        .signal-summary .stats-table th:first-child { text-align: left; padding-left: 12px; }
        .signal-summary .stats-table td:last-child,
        .signal-summary .stats-table th:last-child { background: rgba(255,215,115,0.12); color: #ffda79; font-weight: 600; }
        .signal-summary .stats-table tr:last-child td { border-bottom: none; }
        .signal-summary .stats-total { margin-top: 8px; font-size: 13px; color: rgba(255,255,255,0.7); text-align: right; }
        .signal-summary .stats-total strong { color: #ffda79; }

        /* --- èŠ±è‰²é¸æ“‡åœ“å½¢æŒ‰éˆ• --- */
        .suit-selector { display: flex; gap: 10px; margin-top: 10px; align-items: center; }
        .suit-button { font-family: Georgia, Verdana, sans-serif; font-size: 35px; font-weight: bold; height: 55px; width: 55px; border-radius: 50%; border: solid 1px #ccc; background-color: #ffffff; box-shadow: inset 0px 2px 8px -4px rgba(0,0,0,0.2); display: flex; align-items: center; justify-content: center; text-decoration: none; cursor: pointer; transition: all 0.2s ease; }
        .suit-button.é»‘æ¡ƒ { color: #113285; }
        .suit-button.æ„›å¿ƒ { color: #E83015; }
        .suit-button.æ–¹å¡Š { color: #E98B2A; }
        .suit-button.æ¢…èŠ± { color: #4A593D; }
        .suit-button.selected { color: #ffffff !important; border-width: 2px; transform: scale(1.05); box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
        .suit-button.é»‘æ¡ƒ.selected { background-color: #113285; border-color: #0b225a; }
        .suit-button.æ„›å¿ƒ.selected { background-color: #E83015; border-color: #b82611; }
        .suit-button.æ–¹å¡Š.selected { background-color: #E98B2A; border-color: #b96e21; }
        .suit-button.æ¢…èŠ±.selected { background-color: #4A593D; border-color: #35412d; }
        .suit-button:active { transform: scale(1); top: 1px; }

        
    </style>

    <!-- Excel åŒ¯å‡ºå¥—ä»¶ -->
    <script src="https://cdn.jsdelivr.net/npm/exceljs/dist/exceljs.min.js"></script>
</head>
<body>
    <!-- =================================================================== -->
    <!-- === 3. é é¢ä¸»é«”å…§å®¹ (Body) === -->
    <!-- =================================================================== -->

    <!-- æ‡¸æµ®æŒ‰éˆ•ï¼šè¿”å›ä¸»é  -->
    <button class="back-to-main" id="backToMain" title="è¿”å›ä¸»é ">ğŸ </button>
    
    <!-- ä¸»è¦å…§å®¹å®¹å™¨ -->
    <div class="container">
        
        <!-- å€å¡Šä¸€ï¼šå‰µå»ºå€ -->
        <div class="controls">
            
            <!-- Så±€è¨Šè™Ÿè¨­å®š -->
            <div style="margin-bottom: 15px;">
                <label><strong>Så±€è¨Šè™Ÿè¨­å®šï¼š</strong></label>
                <div style="padding-left: 15px; margin-top: 5px;">
                    <!-- èŠ±è‰²é¸æ“‡ -->
                    <div class="control-inline">
                        <label>èŠ±è‰²é¸æ“‡ï¼š</label>
                        <div class="quick-btn-group">
                            <button type="button" class="quick-btn" onclick="selectAllSuits()">å…¨é¸</button>
                            <button type="button" class="quick-btn" onclick="clearAllSuits()">æ¸…ç©º</button>
                            <button type="button" class="quick-btn" onclick="selectRedSuits()">ç´…è‰²</button>
                        </div>
                        <div class="suit-selector">
                            <a class="suit-button é»‘æ¡ƒ" data-value="â™ ">â™ </a>
                            <a class="suit-button æ„›å¿ƒ" data-value="â™¥">â™¥</a>
                            <a class="suit-button æ–¹å¡Š" data-value="â™¦">â™¦</a>
                            <a class="suit-button æ¢…èŠ±" data-value="â™£">â™£</a>
                        </div>
                    </div>
                    <!-- æ•¸å­—é¸æ“‡ -->
                    <div class="control-inline" style="margin-top: 10px;">
                        <label>æ•¸å­—é¸æ“‡ï¼š</label>
                        <div class="quick-btn-group">
                            <button type="button" class="quick-btn" onclick="selectAllRanks()">å…¨é¸</button>
                            <button type="button" class="quick-btn" onclick="clearAllRanks()">æ¸…ç©º</button>
                            <button type="button" class="quick-btn" onclick="selectZeroRanks()">0é»ç‰Œ</button>  
                        </div>
                        <div class="rank-checkboxes">
                            <label><input type="checkbox" value="A" class="rank-checkbox"> A</label>
                            <label><input type="checkbox" value="2" class="rank-checkbox"> 2</label>
                            <label><input type="checkbox" value="3" class="rank-checkbox"> 3</label>
                            <label><input type="checkbox" value="4" class="rank-checkbox"> 4</label>
                            <label><input type="checkbox" value="5" class="rank-checkbox"> 5</label>
                            <label><input type="checkbox" value="6" class="rank-checkbox"> 6</label>
                            <label><input type="checkbox" value="7" class="rank-checkbox"> 7</label>
                            <label><input type="checkbox" value="8" class="rank-checkbox"> 8</label>
                            <label><input type="checkbox" value="9" class="rank-checkbox"> 9</label>
                            <label><input type="checkbox" value="10" class="rank-checkbox"> 10</label>
                            <label><input type="checkbox" value="J" class="rank-checkbox"> J</label>
                            <label><input type="checkbox" value="Q" class="rank-checkbox"> Q</label>
                            <label><input type="checkbox" value="K" class="rank-checkbox"> K</label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tå±€è¨Šè™Ÿè¨­å®š -->
            <div style="margin-bottom: 20px;">
                <label><strong>Tå±€è¨Šè™Ÿè¨­å®šï¼š</strong></label>
                <div style="padding-left: 15px; margin-top: 5px;">
                    <label><input type="radio" name="tSignalType" value="twoPairs" checked> å…©å°</label>
                </div>
            </div>

            <!-- å‰µå»ºå€çš„ä¸»è¦æ“ä½œæŒ‰éˆ• -->
            <button id="generateBtn">ç”Ÿæˆç‰Œé´</button>
            <button id="applyConfigBtn">æ‡‰ç”¨è¨­å®š</button>
            <strong>è¨Šè™Ÿç‰Œå¼µæ•¸ï¼š<span id="signalCardCount" style="color: #28a745; font-size: 18px;">0</span> å¼µ</strong>
        </div>

        <!-- å€å¡ŠäºŒï¼šç·¨è¼¯å€ -->
        <div class="panel-dark">
            <div class="edit-buttons">
                <button class="btn" id="btnEdit" disabled>ç·¨è¼¯</button>
                <button class="btn" id="btnSwap" disabled>å¡äº¤æ›</button>
                <button class="btn" id="btnRound" disabled>å±€äº¤æ›</button>
                <button class="btn" id="btnAutoColor" disabled>å¡è‰²</button>
                <button class="btn secondary" id="btnCancelEdit" disabled>å–æ¶ˆ</button>
                <button class="btn primary" id="btnApplyChanges" disabled>å¥—ç”¨</button>
                <button class="btn alert" id="clearBtn">æ¸…ç©º</button>
            </div>
            <div class="hotkey-info">
                <div class="hotkey-item"><span class="hotkey-key">Z</span><span>ç·¨è¼¯</span></div>
                <div class="hotkey-item"><span class="hotkey-key">X</span><span>å¡äº¤æ›</span></div>
                <div class="hotkey-item"><span class="hotkey-key">K</span><span>å¡è‰²</span></div>
                <div class="hotkey-item"><span class="hotkey-key">A</span><span>å¥—ç”¨</span></div>
                <div class="hotkey-item"><span class="hotkey-key">G</span><span>å‰µå»º</span></div>
                <div class="hotkey-item"><span class="hotkey-key">V</span><span>é è¦½</span></div>
                <div class="hotkey-item"><span class="hotkey-key">Esc</span><span>å–æ¶ˆ</span></div>
                <div class="hotkey-item"><span class="hotkey-key">C</span><span>åˆ‡ç‰Œ</span></div>
                <div class="hotkey-item"><span class="hotkey-key">U</span><span>CSV å°å‡º</span></div>
                <div class="hotkey-item"><span class="hotkey-key">Ctrl+X</span><span>Excel åŒ¯å‡º</span></div>
                <div class="hotkey-item"><span class="hotkey-key">Ctrl+P</span><span>åˆ—å°</span></div>
                <div class="hotkey-item"><span class="hotkey-key">Tab</span><span>åˆ‡æ›ç„¦é»</span></div>
                <div class="hotkey-item"><span class="hotkey-key">?</span><span>å¿«æ·éµæç¤º</span></div>
            </div>
        </div>

        <!-- å€å¡Šä¸‰ï¼šåˆ‡ç‰Œ / å°å‡ºå·¥å…· -->
        <div class="panel-dark">
            <div class="tool-buttons">
                <div class="input-inline">
                    <label for="cutPos">åˆ‡ç‰Œå¼µæ•¸</label>
                    <input id="cutPos" type="number" min="0" value="0">
                </div>
                <button class="btn" id="btnCut">åˆ‡ç‰Œ</button>
                <button class="btn" id="btnExportCombined">å°å‡º</button>
                <button class="btn" id="btnPreview">é è¦½</button>
                <button class="btn" id="btnSpeech">èªéŸ³</button>
                <button class="btn secondary" id="btnApplyTools">è¨ˆç®—å·¥å…·</button>
            </div>
        </div>

        <!-- å€å¡Šä¸‰ï¼šçµ±è¨ˆæ•¸æ“šå„€è¡¨æ¿ -->
        <div class="stats">
            <div class="stat-card"><h3>ç¸½å±€æ•¸</h3><div class="value" id="totalRounds">0</div></div>
            <div class="stat-card"><h3>èŠå®¶å±€æ•¸</h3><div class="value" id="bankerCount">0</div></div>
            <div class="stat-card"><h3>é–’å®¶å±€æ•¸</h3><div class="value" id="playerCount">0</div></div>
            <div class="stat-card"><h3>å’Œå±€æ•¸</h3><div class="value" id="tieCount">0</div></div>
            <div class="stat-card"><h3>Så±€è¨Šè™Ÿç‰Œå¼µæ•¸</h3><div class="value" id="sSignalCards">0</div></div>
            <div class="stat-card"><h3>éSå±€è¨Šè™Ÿç‰Œå¼µæ•¸</h3><div class="value" id="tSignalCards">0</div></div>
            <div class="stat-card"><h3>å…©å°å±€æ•¸</h3><div class="value" id="twoPairsCount">0</div></div>
        </div>

        <!-- å€å¡Šå››ï¼‹äº”ï¼šå·¦è¡¨å³èªŒ -->
<div class="results-split">
  <div class="left-pane">
    <table class="rounds-table" id="roundsTable" style="display: none;">
      <thead>
        <tr>
          <th>å±€è™Ÿ</th><th>æ®µä½</th><th>å¡ç‰Œ</th><th>å¡è‰²</th>
          <th>çµæœ</th><th>ä¸‹ä¸€å±€</th><th>å°èª¿å¾Œçµæœ</th><th>Så±€è¨Šè™Ÿ</th><th>éSå±€è¨Šè™Ÿ</th>
        </tr>
      </thead>
      <tbody id="roundsBody"></tbody>
    </table>
  </div>

  <div class="right-pane">
    <div class="log" id="logArea"></div>
    <div class="mini-grid-wrapper">
      <div class="grid-preview mini" id="statsGridPreview"><div class="grid-placeholder">å°šç„¡ç‰Œé´è³‡æ–™</div></div>
    </div>
    <div class="signal-summary" id="signalSummary"></div>
  </div>
</div>


    <!-- =================================================================== -->
    <!-- === 4. JavaScript è…³æœ¬å€ (Scripting) === -->
    <!-- =================================================================== -->

    <!-- è…³æœ¬ä¸€ï¼šè¿”å›ä¸»é æŒ‰éˆ•çš„åŠŸèƒ½ -->

    <script>
        document.getElementById('backToMain').addEventListener('click', () => {
            window.location.href = 'index.html'; // é»æ“Šå¾Œè·³è½‰åˆ° index.html
        });
    </script>

    <!-- è…³æœ¬äºŒï¼šèŠ±è‰²åœ“å½¢æŒ‰éˆ•èˆ‡èˆŠç‰ˆ checkbox ä¹‹é–“çš„æ©‹æ¥ç¨‹å¼ç¢¼ -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- åˆå§‹åŒ–åœ“å½¢æŒ‰éˆ•çš„é»æ“Šäº‹ä»¶ ---
            const suitButtons = document.querySelectorAll('.suit-button');
            suitButtons.forEach(button => {
                button.addEventListener('click', (event) => {
                    event.preventDefault(); // é˜²æ­¢ <a> æ¨™ç±¤è·³è½‰
                    button.classList.toggle('selected'); // åˆ‡æ›é¸ä¸­/æœªé¸ä¸­ç‹€æ…‹
                    // æ¯æ¬¡é»æ“Šéƒ½è§¸ç™¼ä¸€æ¬¡å¼µæ•¸è¨ˆç®—
                    if (typeof window.updateSignalCardCount === 'function') {
                        window.updateSignalCardCount();
                    }
                });
            });

            // --- è®“èˆŠçš„å¿«é€Ÿé¸æ“‡å‡½å¼ä¹Ÿèƒ½æ“ä½œæ–°çš„åœ“å½¢æŒ‰éˆ• ---
            window.selectAllSuits = function() {
                suitButtons.forEach(btn => btn.classList.add('selected'));
                if (typeof window.updateSignalCardCount === 'function') { window.updateSignalCardCount(); }
            }
            window.clearAllSuits = function() {
                suitButtons.forEach(btn => btn.classList.remove('selected'));
                if (typeof window.updateSignalCardCount === 'function') { window.updateSignalCardCount(); }
            }
            window.selectRedSuits = function() {
                suitButtons.forEach(btn => {
                    const value = btn.dataset.value;
                    if (value === 'â™¥' || value === 'â™¦') {
                        btn.classList.add('selected');
                    } else {
                        btn.classList.remove('selected');
                    }
                });
                if (typeof window.updateSignalCardCount === 'function') { window.updateSignalCardCount(); }
            }

            // --- æ ¸å¿ƒæ©‹æ¥ï¼šè®“ signals.js èƒ½è®€å–åˆ°åœ“å½¢æŒ‰éˆ•çš„é¸æ“‡çµæœ ---
            function getSelectedSuitsFromButtons() {
                const selectedButtons = document.querySelectorAll('.suit-button.selected');
                return Array.from(selectedButtons).map(btn => btn.dataset.value);
            }

            // --- è¦†å¯«èˆŠçš„å‡½å¼ï¼Œè®“å®ƒå€‘ä½¿ç”¨æ–°çš„è®€å–æ–¹å¼ ---
            if (typeof window.updateSignalCardCount === 'function') {
                const originalUpdate = window.updateSignalCardCount; // ä¿ç•™åŸå§‹å‡½å¼ä»¥å‚™ä¸æ™‚ä¹‹éœ€
                window.updateSignalCardCount = function() {
                    const suits = getSelectedSuitsFromButtons(); // å¾åœ“å½¢æŒ‰éˆ•è®€å–
                    const ranks = Array.from(document.querySelectorAll('.rank-checkbox:checked')).map(cb => cb.value);
                    const totalCards = suits.length * ranks.length * 8;
                    const countElement = document.getElementById('signalCardCount');
                    if (countElement) {
                        countElement.textContent = totalCards;
                        if (totalCards === 0) countElement.style.color = '#dc3545';
                        else if (totalCards <= 64) countElement.style.color = '#28a745';
                        else if (totalCards <= 128) countElement.style.color = '#ffc107';
                        else countElement.style.color = '#fd7e14';
                    }
                }
            }
            if (typeof window.applySignalConfig === 'function') {
                const originalApply = window.applySignalConfig; // ä¿ç•™åŸå§‹å‡½å¼
                window.applySignalConfig = function() {
                    const suits = getSelectedSuitsFromButtons(); // å¾åœ“å½¢æŒ‰éˆ•è®€å–
                    const ranks = Array.from(document.querySelectorAll('.rank-checkbox:checked')).map(cb => cb.value);
                    
                    // æ›´æ–°åˆ° signals.js çš„æ ¸å¿ƒé‚è¼¯ä¸­
                    if (window.RedZeroLogic && typeof window.RedZeroLogic.updateSignalConfig === 'function') {
                         window.RedZeroLogic.updateSignalConfig({ suits, ranks });
                    } else if (typeof SIGNAL_CONFIG !== 'undefined') { // å‚™ç”¨æ–¹æ¡ˆ
                        SIGNAL_CONFIG.suits = suits;
                        SIGNAL_CONFIG.ranks = ranks;
                    }
                    
                    // å¯«å…¥æ—¥èªŒ
                    log(`è¨Šè™Ÿè¨­å®šå·²æ›´æ–°ï¼šèŠ±è‰²[${suits.join(',')}] æ•¸å­—[${ranks.join(',')}]`, 'success');
                    log(`é è¨ˆè¨Šè™Ÿç‰Œç¸½æ•¸ï¼š${suits.length * ranks.length * 8}å¼µ`, 'info');
                }
            }

            // --- é é¢è¼‰å…¥æ™‚ï¼Œä¾ç…§å·²ä¿å­˜è¨­å®šåŒæ­¥ UI ---
            if (typeof window.syncSignalUiFromConfig === 'function') {
                window.syncSignalUiFromConfig();
            } else if (window.RedZeroLogic && typeof window.RedZeroLogic.syncSignalUiFromConfig === 'function') {
                window.RedZeroLogic.syncSignalUiFromConfig();
            }
            if (typeof window.updateSignalCardCount === 'function') window.updateSignalCardCount();
        });
    </script>

    <!-- è…³æœ¬ä¸‰ï¼šå¼•ç”¨æ‚¨çš„æ ¸å¿ƒé‚è¼¯æª”æ¡ˆ -->
    <script src="signals.js"></script>
</body>
</html>
